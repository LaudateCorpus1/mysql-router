{
  "stmts": [
    {
      "stmt": "SELECT * FROM mysql_innodb_cluster_metadata.schema_version",
      "result": {
        "columns": [
          {
            "type": "LONGLONG",
            "name": "major"
          },
          {
            "type": "LONGLONG",
            "name": "minor"
          },
          {
            "type": "LONGLONG",
            "name": "patch"
          }
        ],
        "rows": [
          [
            1,
            0,
            1
          ]
        ]
      }
    },
    {
      "stmt": "SELECT  ((SELECT count(*) FROM mysql_innodb_cluster_metadata.clusters) <= 1  AND (SELECT count(*) FROM mysql_innodb_cluster_metadata.replicasets) <= 1) as has_one_replicaset, (SELECT attributes->>'$.group_replication_group_name' FROM mysql_innodb_cluster_metadata.replicasets)  = @@group_replication_group_name as replicaset_is_ours",
      "result": {
        "columns": [
          {
            "type": "LONGLONG",
            "name": "has_one_replicaset"
          },
          {
            "type": "LONGLONG",
            "name": "replicaset_is_ours"
          }
        ],
        "rows": [
          [
            1,
            1
          ]
        ]
      }
    },
    {
      "stmt": "SELECT member_state FROM performance_schema.replication_group_members WHERE member_id = @@server_uuid",
      "result": {
        "columns": [
          {
            "type": "STRING",
            "name": "member_state"
          }
        ],
        "rows": [
          [
            "ONLINE"
          ]
        ]
      }
    },
    {
      "stmt": "SELECT SUM(IF(member_state = 'ONLINE', 1, 0)) as num_onlines, COUNT(*) as num_total FROM performance_schema.replication_group_members",
      "result": {
        "columns": [
          {
            "type": "LONGLONG",
            "name": "num_onlines"
          },
          {
            "type": "LONGLONG",
            "name": "num_total"
          }
        ],
        "rows": [
          [
            3,
            3
          ]
        ]
      }
    },
    {
      "stmt": "SELECT @@group_replication_single_primary_mode=1 as single_primary_mode,        (SELECT variable_value FROM performance_schema.global_status WHERE variable_name='group_replication_primary_member') as primary_member,         @@server_uuid as my_uuid",
      "result": {
        "columns": [
          {
            "type": "LONGLONG",
            "name": "single_primary_mode"
          },
          {
            "type": "STRING",
            "name": "primary_member"
          },
          {
            "type": "STRING",
            "name": "my_uuid"
          }
        ],
        "rows": [
          [
            1,
            "b66e4c6f-e15f-11e6-90b0-507b9d70900f",
            "b66e4c6f-e15f-11e6-90b0-507b9d70900f"
          ]
        ]
      }
    },
    {
      "stmt": "show status like 'ssl_cipher'",
      "result": {
        "columns": [
          {
            "type": "STRING",
            "name": "Variable_name"
          },
          {
            "type": "STRING",
            "name": "Value"
          }
        ],
        "rows": [
          [
            "Ssl_cipher",
            ""
          ]
        ]
      }
    },
    {
      "stmt": "SELECT F.cluster_name, R.replicaset_name, R.topology_type, JSON_UNQUOTE(JSON_EXTRACT(I.addresses, '$.mysqlClassic')) FROM mysql_innodb_cluster_metadata.clusters AS F, mysql_innodb_cluster_metadata.instances AS I, mysql_innodb_cluster_metadata.replicasets AS R WHERE R.replicaset_id = (SELECT replicaset_id FROM mysql_innodb_cluster_metadata.instances WHERE mysql_server_uuid = @@server_uuid)AND I.replicaset_id = R.replicaset_id AND R.cluster_id = F.cluster_id",
      "result": {
        "columns": [
          {
            "type": "LONGLONG",
            "name": "cluster_name"
          },
          {
            "type": "STRING",
            "name": "replicaset_name"
          },
          {
            "type": "STRING",
            "name": "topology_type"
          },
          {
            "type": "STRING",
            "name": "JSON_UNQUOTE(JSON_EXTRACT(I.addresses, '$.mysqlClassic'))"
          },
          {
            "type": "STRING",
            "name": "fake",
            "repeat": "4194304",
            "comment": "Additional field that we use to force generating of big packets"
          }
        ],
        "rows": [
          [
            "test",
            "default",
            "pm",
            "localhost:5500",
            "x"
          ],
          [
            "test",
            "default",
            "pm",
            "localhost:5510",
            ""
          ],
          [
            "test",
            "default",
            "pm",
            "localhost:5520",
            ""
          ]
        ]
      }
    },
    {
      "stmt": "START TRANSACTION",
      "ok": null
    },
    {
      "stmt.regex": "SELECT host_id, host_name, ip_address FROM mysql_innodb_cluster_metadata.hosts WHERE host_name = '.*' LIMIT 1",
      "result": {
        "columns": [
          {
            "type": "STRING",
            "name": "host_id"
          },
          {
            "type": "STRING",
            "name": "host_name"
          },
          {
            "type": "STRING",
            "name": "ip_address"
          }
        ]
      }
    },
    {
      "stmt.regex": "^INSERT INTO mysql_innodb_cluster_metadata.hosts.*",
      "ok": null
    },
    {
      "stmt.regex": "^INSERT INTO mysql_innodb_cluster_metadata.routers.*",
      "ok": null
    },
    {
      "stmt.regex": "^DROP USER IF EXISTS mysql_router.*",
      "ok": null
    },
    {
      "stmt.regex": "^CREATE USER mysql_router.*",
      "ok": null
    },
    {
      "stmt.regex": "^GRANT SELECT ON mysql_innodb_cluster_metadata.*",
      "ok": null
    },
    {
      "stmt.regex": "^GRANT SELECT ON performance_schema.*",
      "ok": null
    },
    {
      "stmt.regex": "^GRANT SELECT ON performance_schema.*",
      "ok": null
    },
    {
      "stmt.regex": "^UPDATE mysql_innodb_cluster_metadata\\.routers.*",
      "ok": null
    },
    {
      "stmt": "COMMIT",
      "ok": null
    }
  ]
}
